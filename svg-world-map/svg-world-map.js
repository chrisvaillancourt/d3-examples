import{i as n,a as t,b as r,f as e,p as i,c as o,d as u,e as a,g as c,j as l,s as f}from"../precisionRound-de7a9f9e.js";var s={},p={};function h(n){return new Function("d","return {"+n.map((function(n,t){return JSON.stringify(n)+": d["+t+'] || ""'})).join(",")+"}")}function d(n){var t=Object.create(null),r=[];return n.forEach((function(n){for(var e in n)e in t||r.push(t[e]=e)})),r}function g(n,t){var r=n+"",e=r.length;return e<t?new Array(t-e+1).join(0)+r:r}function v(n){var t,r=n.getUTCHours(),e=n.getUTCMinutes(),i=n.getUTCSeconds(),o=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":((t=n.getUTCFullYear())<0?"-"+g(-t,6):t>9999?"+"+g(t,6):g(t,4))+"-"+g(n.getUTCMonth()+1,2)+"-"+g(n.getUTCDate(),2)+(o?"T"+g(r,2)+":"+g(e,2)+":"+g(i,2)+"."+g(o,3)+"Z":i?"T"+g(r,2)+":"+g(e,2)+":"+g(i,2)+"Z":e||r?"T"+g(r,2)+":"+g(e,2)+"Z":"")}var y=function(n){var t=new RegExp('["'+n+"\n\r]"),r=n.charCodeAt(0);function e(n,t){var e,i=[],o=n.length,u=0,a=0,c=o<=0,l=!1;function f(){if(c)return p;if(l)return l=!1,s;var t,e,i=u;if(34===n.charCodeAt(i)){for(;u++<o&&34!==n.charCodeAt(u)||34===n.charCodeAt(++u););return(t=u)>=o?c=!0:10===(e=n.charCodeAt(u++))?l=!0:13===e&&(l=!0,10===n.charCodeAt(u)&&++u),n.slice(i+1,t-1).replace(/""/g,'"')}for(;u<o;){if(10===(e=n.charCodeAt(t=u++)))l=!0;else if(13===e)l=!0,10===n.charCodeAt(u)&&++u;else if(e!==r)continue;return n.slice(i,t)}return c=!0,n.slice(i,o)}for(10===n.charCodeAt(o-1)&&--o,13===n.charCodeAt(o-1)&&--o;(e=f())!==p;){for(var h=[];e!==s&&e!==p;)h.push(e),e=f();t&&null==(h=t(h,a++))||i.push(h)}return i}function i(t,r){return t.map((function(t){return r.map((function(n){return u(t[n])})).join(n)}))}function o(t){return t.map(u).join(n)}function u(n){return null==n?"":n instanceof Date?v(n):t.test(n+="")?'"'+n.replace(/"/g,'""')+'"':n}return{parse:function(n,t){var r,i,o=e(n,(function(n,e){if(r)return r(n,e-1);i=n,r=t?function(n,t){var r=h(n);return function(e,i){return t(r(e),i,n)}}(n,t):h(n)}));return o.columns=i||[],o},parseRows:e,format:function(t,r){return null==r&&(r=d(t)),[r.map(u).join(n)].concat(i(t,r)).join("\n")},formatBody:function(n,t){return null==t&&(t=d(n)),i(n,t).join("\n")},formatRows:function(n){return n.map(o).join("\n")},formatRow:o,formatValue:u}}(",").parse;function m(n){if(!n.ok)throw new Error(n.status+" "+n.statusText);return n.text()}function M(n,t){return fetch(n,t).then(m)}var S,E=(S=y,function(n,t,r){return 2===arguments.length&&"function"==typeof t&&(r=t,t=void 0),M(n,t).then((function(n){return S(n,r)}))});function x(){return new w}function w(){this.reset()}w.prototype={constructor:w,reset:function(){this.s=this.t=0},add:function(n){_(N,n,this.t),_(this,N.s,this.s),this.s?this.t+=N.t:this.s=N.t},valueOf:function(){return this.s}};var N=new w;function _(n,t,r){var e=n.s=t+r,i=e-t,o=e-i;n.t=t-o+(r-i)}var b=1e-6,A=Math.PI,j=A/2,C=A/4,k=2*A,T=180/A,P=A/180,R=Math.abs,L=Math.atan,U=Math.atan2,z=Math.cos,F=Math.ceil,H=Math.sin,O=Math.sign||function(n){return n>0?1:n<0?-1:0},W=Math.sqrt;function $(n){return n>1?j:n<-1?-j:Math.asin(n)}function q(){}function D(n,t){n&&G.hasOwnProperty(n.type)&&G[n.type](n,t)}var Z={Feature:function(n,t){D(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=-1,i=r.length;++e<i;)D(r[e].geometry,t)}},G={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)n=r[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){I(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)I(r[e],t,0)},Polygon:function(n,t){Y(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,e=-1,i=r.length;++e<i;)Y(r[e],t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=-1,i=r.length;++e<i;)D(r[e],t)}};function I(n,t,r){var e,i=-1,o=n.length-r;for(t.lineStart();++i<o;)e=n[i],t.point(e[0],e[1],e[2]);t.lineEnd()}function Y(n,t){var r=-1,e=n.length;for(t.polygonStart();++r<e;)I(n[r],t,1);t.polygonEnd()}function B(n,t){n&&Z.hasOwnProperty(n.type)?Z[n.type](n,t):D(n,t)}function J(n){return[U(n[1],n[0]),$(n[2])]}function V(n){var t=n[0],r=n[1],e=z(r);return[e*z(t),e*H(t),H(r)]}function X(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function K(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Q(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function nn(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function tn(n){var t=W(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function rn(n,t){function r(r,e){return r=n(r,e),t(r[0],r[1])}return n.invert&&t.invert&&(r.invert=function(r,e){return(r=t.invert(r,e))&&n.invert(r[0],r[1])}),r}function en(n,t){return[R(n)>A?n+Math.round(-n/k)*k:n,t]}function on(n){return function(t,r){return[(t+=n)>A?t-k:t<-A?t+k:t,r]}}function un(n){var t=on(n);return t.invert=on(-n),t}function an(n,t){var r=z(n),e=H(n),i=z(t),o=H(t);function u(n,t){var u=z(t),a=z(n)*u,c=H(n)*u,l=H(t),f=l*r+a*e;return[U(c*i-f*o,a*r-l*e),$(f*i+c*o)]}return u.invert=function(n,t){var u=z(t),a=z(n)*u,c=H(n)*u,l=H(t),f=l*i-c*o;return[U(c*i+l*o,a*r+f*e),$(f*r-a*e)]},u}function cn(n,t){(t=V(t))[0]-=n,tn(t);var r,e=(r=-t[1])>1?0:r<-1?A:Math.acos(r);return((-t[2]<0?-e:e)+k-b)%k}function ln(){var n,t=[];return{point:function(t,r,e){n.push([t,r,e])},lineStart:function(){t.push(n=[])},lineEnd:q,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],n=null,r}}}function fn(n,t){return R(n[0]-t[0])<b&&R(n[1]-t[1])<b}function sn(n,t,r,e){this.x=n,this.z=t,this.o=r,this.e=e,this.v=!1,this.n=this.p=null}function pn(n,t,r,e,i){var o,u,a=[],c=[];if(n.forEach((function(n){if(!((t=n.length-1)<=0)){var t,r,e=n[0],u=n[t];if(fn(e,u)){if(!e[2]&&!u[2]){for(i.lineStart(),o=0;o<t;++o)i.point((e=n[o])[0],e[1]);return void i.lineEnd()}u[0]+=2e-6}a.push(r=new sn(e,n,null,!0)),c.push(r.o=new sn(e,null,r,!1)),a.push(r=new sn(u,n,null,!1)),c.push(r.o=new sn(u,null,r,!0))}})),a.length){for(c.sort(t),hn(a),hn(c),o=0,u=c.length;o<u;++o)c[o].e=r=!r;for(var l,f,s=a[0];;){for(var p=s,h=!0;p.v;)if((p=p.n)===s)return;l=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(h)for(o=0,u=l.length;o<u;++o)i.point((f=l[o])[0],f[1]);else e(p.x,p.n.x,1,i);p=p.n}else{if(h)for(l=p.p.z,o=l.length-1;o>=0;--o)i.point((f=l[o])[0],f[1]);else e(p.x,p.p.x,-1,i);p=p.p}l=(p=p.o).z,h=!h}while(!p.v);i.lineEnd()}}}function hn(n){if(t=n.length){for(var t,r,e=0,i=n[0];++e<t;)i.n=r=n[e],r.p=i,i=r;i.n=r=n[0],r.p=i}}en.invert=en;var dn=x();function gn(n){return R(n[0])<=A?n[0]:O(n[0])*((R(n[0])+A)%k-A)}function vn(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}var yn,mn;1===(yn=vn).length&&(mn=yn,yn=function(n,t){return vn(mn(n),t)});function Mn(n,t,r){n=+n,t=+t,r=(i=arguments.length)<2?(t=n,n=0,1):i<3?1:+r;for(var e=-1,i=0|Math.max(0,Math.ceil((t-n)/r)),o=new Array(i);++e<i;)o[e]=n+e*r;return o}function Sn(n){for(var t,r,e,i=n.length,o=-1,u=0;++o<i;)u+=n[o].length;for(r=new Array(u);--i>=0;)for(t=(e=n[i]).length;--t>=0;)r[--u]=e[t];return r}function En(n,t,r,e){return function(i){var o,u,a,c=t(i),l=ln(),f=t(l),s=!1,p={point:h,lineStart:g,lineEnd:v,polygonStart:function(){p.point=y,p.lineStart=m,p.lineEnd=M,u=[],o=[]},polygonEnd:function(){p.point=h,p.lineStart=g,p.lineEnd=v,u=Sn(u);var n=function(n,t){var r=gn(t),e=t[1],i=H(e),o=[H(r),-z(r),0],u=0,a=0;dn.reset(),1===i?e=j+b:-1===i&&(e=-j-b);for(var c=0,l=n.length;c<l;++c)if(s=(f=n[c]).length)for(var f,s,p=f[s-1],h=gn(p),d=p[1]/2+C,g=H(d),v=z(d),y=0;y<s;++y,h=M,g=E,v=x,p=m){var m=f[y],M=gn(m),S=m[1]/2+C,E=H(S),x=z(S),w=M-h,N=w>=0?1:-1,_=N*w,T=_>A,P=g*E;if(dn.add(U(P*N*H(_),v*x+P*z(_))),u+=T?w+N*k:w,T^h>=r^M>=r){var R=K(V(p),V(m));tn(R);var L=K(o,R);tn(L);var F=(T^w>=0?-1:1)*$(L[2]);(e>F||e===F&&(R[0]||R[1]))&&(a+=T^w>=0?1:-1)}}return(u<-b||u<b&&dn<-b)^1&a}(o,e);u.length?(s||(i.polygonStart(),s=!0),pn(u,wn,n,r,i)):n&&(s||(i.polygonStart(),s=!0),i.lineStart(),r(null,null,1,i),i.lineEnd()),s&&(i.polygonEnd(),s=!1),u=o=null},sphere:function(){i.polygonStart(),i.lineStart(),r(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(t,r){n(t,r)&&i.point(t,r)}function d(n,t){c.point(n,t)}function g(){p.point=d,c.lineStart()}function v(){p.point=h,c.lineEnd()}function y(n,t){a.push([n,t]),f.point(n,t)}function m(){f.lineStart(),a=[]}function M(){y(a[0][0],a[0][1]),f.lineEnd();var n,t,r,e,c=f.clean(),p=l.result(),h=p.length;if(a.pop(),o.push(a),a=null,h)if(1&c){if((t=(r=p[0]).length-1)>0){for(s||(i.polygonStart(),s=!0),i.lineStart(),n=0;n<t;++n)i.point((e=r[n])[0],e[1]);i.lineEnd()}}else h>1&&2&c&&p.push(p.pop().concat(p.shift())),u.push(p.filter(xn))}return p}}function xn(n){return n.length>1}function wn(n,t){return((n=n.x)[0]<0?n[1]-j-b:j-n[1])-((t=t.x)[0]<0?t[1]-j-b:j-t[1])}var Nn=En((function(){return!0}),(function(n){var t,r=NaN,e=NaN,i=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(o,u){var a=o>0?A:-A,c=R(o-r);R(c-A)<b?(n.point(r,e=(e+u)/2>0?j:-j),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),n.point(o,e),t=0):i!==a&&c>=A&&(R(r-i)<b&&(r-=i*b),R(o-a)<b&&(o-=a*b),e=function(n,t,r,e){var i,o,u=H(n-r);return R(u)>b?L((H(t)*(o=z(e))*H(r)-H(e)*(i=z(t))*H(n))/(i*o*u)):(t+e)/2}(r,e,o,u),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),t=0),n.point(r=o,e=u),i=a},lineEnd:function(){n.lineEnd(),r=e=NaN},clean:function(){return 2-t}}}),(function(n,t,r,e){var i;if(null==n)i=r*j,e.point(-A,i),e.point(0,i),e.point(A,i),e.point(A,0),e.point(A,-i),e.point(0,-i),e.point(-A,-i),e.point(-A,0),e.point(-A,i);else if(R(n[0]-t[0])>b){var o=n[0]<t[0]?A:-A;i=r*o/2,e.point(-o,i),e.point(0,i),e.point(o,i)}else e.point(t[0],t[1])}),[-A,-j]);function _n(n){var t=z(n),r=6*P,e=t>0,i=R(t)>b;function o(n,r){return z(n)*z(r)>t}function u(n,r,e){var i=[1,0,0],o=K(V(n),V(r)),u=X(o,o),a=o[0],c=u-a*a;if(!c)return!e&&n;var l=t*u/c,f=-t*a/c,s=K(i,o),p=nn(i,l);Q(p,nn(o,f));var h=s,d=X(p,h),g=X(h,h),v=d*d-g*(X(p,p)-1);if(!(v<0)){var y=W(v),m=nn(h,(-d-y)/g);if(Q(m,p),m=J(m),!e)return m;var M,S=n[0],E=r[0],x=n[1],w=r[1];E<S&&(M=S,S=E,E=M);var N=E-S,_=R(N-A)<b;if(!_&&w<x&&(M=x,x=w,w=M),_||N<b?_?x+w>0^m[1]<(R(m[0]-S)<b?x:w):x<=m[1]&&m[1]<=w:N>A^(S<=m[0]&&m[0]<=E)){var j=nn(h,(-d+y)/g);return Q(j,p),[m,J(j)]}}}function a(t,r){var i=e?n:A-n,o=0;return t<-i?o|=1:t>i&&(o|=2),r<-i?o|=4:r>i&&(o|=8),o}return En(o,(function(n){var t,r,c,l,f;return{lineStart:function(){l=c=!1,f=1},point:function(s,p){var h,d=[s,p],g=o(s,p),v=e?g?0:a(s,p):g?a(s+(s<0?A:-A),p):0;if(!t&&(l=c=g)&&n.lineStart(),g!==c&&(!(h=u(t,d))||fn(t,h)||fn(d,h))&&(d[2]=1),g!==c)f=0,g?(n.lineStart(),h=u(d,t),n.point(h[0],h[1])):(h=u(t,d),n.point(h[0],h[1],2),n.lineEnd()),t=h;else if(i&&t&&e^g){var y;v&r||!(y=u(d,t,!0))||(f=0,e?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1],3)))}!g||t&&fn(t,d)||n.point(d[0],d[1]),t=d,c=g,r=v},lineEnd:function(){c&&n.lineEnd(),t=null},clean:function(){return f|(l&&c)<<1}}}),(function(t,e,i,o){!function(n,t,r,e,i,o){if(r){var u=z(t),a=H(t),c=e*r;null==i?(i=t+e*k,o=t-c/2):(i=cn(u,i),o=cn(u,o),(e>0?i<o:i>o)&&(i+=e*k));for(var l,f=i;e>0?f>o:f<o;f-=c)l=J([u,-a*z(f),-a*H(f)]),n.point(l[0],l[1])}}(o,n,r,i,t,e)}),e?[0,-n]:[-A,n-A])}function bn(n,t,r,e){function i(i,o){return n<=i&&i<=r&&t<=o&&o<=e}function o(i,o,a,l){var f=0,s=0;if(null==i||(f=u(i,a))!==(s=u(o,a))||c(i,o)<0^a>0)do{l.point(0===f||3===f?n:r,f>1?e:t)}while((f=(f+a+4)%4)!==s);else l.point(o[0],o[1])}function u(e,i){return R(e[0]-n)<b?i>0?0:3:R(e[0]-r)<b?i>0?2:1:R(e[1]-t)<b?i>0?1:0:i>0?3:2}function a(n,t){return c(n.x,t.x)}function c(n,t){var r=u(n,1),e=u(t,1);return r!==e?r-e:0===r?t[1]-n[1]:1===r?n[0]-t[0]:2===r?n[1]-t[1]:t[0]-n[0]}return function(u){var c,l,f,s,p,h,d,g,v,y,m,M=u,S=ln(),E={point:x,lineStart:function(){E.point=w,l&&l.push(f=[]);y=!0,v=!1,d=g=NaN},lineEnd:function(){c&&(w(s,p),h&&v&&S.rejoin(),c.push(S.result()));E.point=x,v&&M.lineEnd()},polygonStart:function(){M=S,c=[],l=[],m=!0},polygonEnd:function(){var t=function(){for(var t=0,r=0,i=l.length;r<i;++r)for(var o,u,a=l[r],c=1,f=a.length,s=a[0],p=s[0],h=s[1];c<f;++c)o=p,u=h,s=a[c],p=s[0],h=s[1],u<=e?h>e&&(p-o)*(e-u)>(h-u)*(n-o)&&++t:h<=e&&(p-o)*(e-u)<(h-u)*(n-o)&&--t;return t}(),r=m&&t,i=(c=Sn(c)).length;(r||i)&&(u.polygonStart(),r&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),i&&pn(c,a,t,o,u),u.polygonEnd());M=u,c=l=f=null}};function x(n,t){i(n,t)&&M.point(n,t)}function w(o,u){var a=i(o,u);if(l&&f.push([o,u]),y)s=o,p=u,h=a,y=!1,a&&(M.lineStart(),M.point(o,u));else if(a&&v)M.point(o,u);else{var c=[d=Math.max(-1e9,Math.min(1e9,d)),g=Math.max(-1e9,Math.min(1e9,g))],S=[o=Math.max(-1e9,Math.min(1e9,o)),u=Math.max(-1e9,Math.min(1e9,u))];!function(n,t,r,e,i,o){var u,a=n[0],c=n[1],l=0,f=1,s=t[0]-a,p=t[1]-c;if(u=r-a,s||!(u>0)){if(u/=s,s<0){if(u<l)return;u<f&&(f=u)}else if(s>0){if(u>f)return;u>l&&(l=u)}if(u=i-a,s||!(u<0)){if(u/=s,s<0){if(u>f)return;u>l&&(l=u)}else if(s>0){if(u<l)return;u<f&&(f=u)}if(u=e-c,p||!(u>0)){if(u/=p,p<0){if(u<l)return;u<f&&(f=u)}else if(p>0){if(u>f)return;u>l&&(l=u)}if(u=o-c,p||!(u<0)){if(u/=p,p<0){if(u>f)return;u>l&&(l=u)}else if(p>0){if(u<l)return;u<f&&(f=u)}return l>0&&(n[0]=a+l*s,n[1]=c+l*p),f<1&&(t[0]=a+f*s,t[1]=c+f*p),!0}}}}}(c,S,n,t,r,e)?a&&(M.lineStart(),M.point(o,u),m=!1):(v||(M.lineStart(),M.point(c[0],c[1])),M.point(S[0],S[1]),a||M.lineEnd(),m=!1)}d=o,g=u,v=a}return E}}function An(n,t,r){var e=Mn(n,t-b,r).concat(t);return function(n){return e.map((function(t){return[n,t]}))}}function jn(n,t,r){var e=Mn(n,t-b,r).concat(t);return function(n){return e.map((function(t){return[t,n]}))}}function Cn(){return function(){var n,t,r,e,i,o,u,a,c,l,f,s,p=10,h=p,d=90,g=360,v=2.5;function y(){return{type:"MultiLineString",coordinates:m()}}function m(){return Mn(F(e/d)*d,r,d).map(f).concat(Mn(F(a/g)*g,u,g).map(s)).concat(Mn(F(t/p)*p,n,p).filter((function(n){return R(n%d)>b})).map(c)).concat(Mn(F(o/h)*h,i,h).filter((function(n){return R(n%g)>b})).map(l))}return y.lines=function(){return m().map((function(n){return{type:"LineString",coordinates:n}}))},y.outline=function(){return{type:"Polygon",coordinates:[f(e).concat(s(u).slice(1),f(r).reverse().slice(1),s(a).reverse().slice(1))]}},y.extent=function(n){return arguments.length?y.extentMajor(n).extentMinor(n):y.extentMinor()},y.extentMajor=function(n){return arguments.length?(e=+n[0][0],r=+n[1][0],a=+n[0][1],u=+n[1][1],e>r&&(n=e,e=r,r=n),a>u&&(n=a,a=u,u=n),y.precision(v)):[[e,a],[r,u]]},y.extentMinor=function(r){return arguments.length?(t=+r[0][0],n=+r[1][0],o=+r[0][1],i=+r[1][1],t>n&&(r=t,t=n,n=r),o>i&&(r=o,o=i,i=r),y.precision(v)):[[t,o],[n,i]]},y.step=function(n){return arguments.length?y.stepMajor(n).stepMinor(n):y.stepMinor()},y.stepMajor=function(n){return arguments.length?(d=+n[0],g=+n[1],y):[d,g]},y.stepMinor=function(n){return arguments.length?(p=+n[0],h=+n[1],y):[p,h]},y.precision=function(p){return arguments.length?(v=+p,c=An(o,i,90),l=jn(t,n,v),f=An(a,u,90),s=jn(e,r,v),y):v},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}()()}function kn(n){return n}var Tn,Pn,Rn,Ln,Un=x(),zn=x(),Fn={point:q,lineStart:q,lineEnd:q,polygonStart:function(){Fn.lineStart=Hn,Fn.lineEnd=$n},polygonEnd:function(){Fn.lineStart=Fn.lineEnd=Fn.point=q,Un.add(R(zn)),zn.reset()},result:function(){var n=Un/2;return Un.reset(),n}};function Hn(){Fn.point=On}function On(n,t){Fn.point=Wn,Tn=Rn=n,Pn=Ln=t}function Wn(n,t){zn.add(Ln*n-Rn*t),Rn=n,Ln=t}function $n(){Wn(Tn,Pn)}var qn=1/0,Dn=qn,Zn=-qn,Gn=Zn,In={point:function(n,t){n<qn&&(qn=n);n>Zn&&(Zn=n);t<Dn&&(Dn=t);t>Gn&&(Gn=t)},lineStart:q,lineEnd:q,polygonStart:q,polygonEnd:q,result:function(){var n=[[qn,Dn],[Zn,Gn]];return Zn=Gn=-(Dn=qn=1/0),n}};var Yn,Bn,Jn,Vn,Xn=0,Kn=0,Qn=0,nt=0,tt=0,rt=0,et=0,it=0,ot=0,ut={point:at,lineStart:ct,lineEnd:st,polygonStart:function(){ut.lineStart=pt,ut.lineEnd=ht},polygonEnd:function(){ut.point=at,ut.lineStart=ct,ut.lineEnd=st},result:function(){var n=ot?[et/ot,it/ot]:rt?[nt/rt,tt/rt]:Qn?[Xn/Qn,Kn/Qn]:[NaN,NaN];return Xn=Kn=Qn=nt=tt=rt=et=it=ot=0,n}};function at(n,t){Xn+=n,Kn+=t,++Qn}function ct(){ut.point=lt}function lt(n,t){ut.point=ft,at(Jn=n,Vn=t)}function ft(n,t){var r=n-Jn,e=t-Vn,i=W(r*r+e*e);nt+=i*(Jn+n)/2,tt+=i*(Vn+t)/2,rt+=i,at(Jn=n,Vn=t)}function st(){ut.point=at}function pt(){ut.point=dt}function ht(){gt(Yn,Bn)}function dt(n,t){ut.point=gt,at(Yn=Jn=n,Bn=Vn=t)}function gt(n,t){var r=n-Jn,e=t-Vn,i=W(r*r+e*e);nt+=i*(Jn+n)/2,tt+=i*(Vn+t)/2,rt+=i,et+=(i=Vn*n-Jn*t)*(Jn+n),it+=i*(Vn+t),ot+=3*i,at(Jn=n,Vn=t)}function vt(n){this._context=n}vt.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._context.moveTo(n,t),this._point=1;break;case 1:this._context.lineTo(n,t);break;default:this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,k)}},result:q};var yt,mt,Mt,St,Et,xt=x(),wt={point:q,lineStart:function(){wt.point=Nt},lineEnd:function(){yt&&_t(mt,Mt),wt.point=q},polygonStart:function(){yt=!0},polygonEnd:function(){yt=null},result:function(){var n=+xt;return xt.reset(),n}};function Nt(n,t){wt.point=_t,mt=St=n,Mt=Et=t}function _t(n,t){St-=n,Et-=t,xt.add(W(St*St+Et*Et)),St=n,Et=t}function bt(){this._string=[]}function At(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function jt(n){return function(t){var r=new Ct;for(var e in n)r[e]=n[e];return r.stream=t,r}}function Ct(){}function kt(n,t,r){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),null!=e&&n.clipExtent(null),B(r,n.stream(In)),t(In.result()),null!=e&&n.clipExtent(e),n}function Tt(n,t,r){return kt(n,(function(r){var e=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=Math.min(e/(r[1][0]-r[0][0]),i/(r[1][1]-r[0][1])),u=+t[0][0]+(e-o*(r[1][0]+r[0][0]))/2,a=+t[0][1]+(i-o*(r[1][1]+r[0][1]))/2;n.scale(150*o).translate([u,a])}),r)}bt.prototype={_radius:4.5,_circle:At(4.5),pointRadius:function(n){return(n=+n)!==this._radius&&(this._radius=n,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._string.push("M",n,",",t),this._point=1;break;case 1:this._string.push("L",n,",",t);break;default:null==this._circle&&(this._circle=At(this._radius)),this._string.push("M",n,",",t,this._circle)}},result:function(){if(this._string.length){var n=this._string.join("");return this._string=[],n}return null}},Ct.prototype={constructor:Ct,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Pt=z(30*P);function Rt(n,t){return+t?function(n,t){function r(e,i,o,u,a,c,l,f,s,p,h,d,g,v){var y=l-e,m=f-i,M=y*y+m*m;if(M>4*t&&g--){var S=u+p,E=a+h,x=c+d,w=W(S*S+E*E+x*x),N=$(x/=w),_=R(R(x)-1)<b||R(o-s)<b?(o+s)/2:U(E,S),A=n(_,N),j=A[0],C=A[1],k=j-e,T=C-i,P=m*k-y*T;(P*P/M>t||R((y*k+m*T)/M-.5)>.3||u*p+a*h+c*d<Pt)&&(r(e,i,o,u,a,c,j,C,_,S/=w,E/=w,x,g,v),v.point(j,C),r(j,C,_,S,E,x,l,f,s,p,h,d,g,v))}}return function(t){var e,i,o,u,a,c,l,f,s,p,h,d,g={point:v,lineStart:y,lineEnd:M,polygonStart:function(){t.polygonStart(),g.lineStart=S},polygonEnd:function(){t.polygonEnd(),g.lineStart=y}};function v(r,e){r=n(r,e),t.point(r[0],r[1])}function y(){f=NaN,g.point=m,t.lineStart()}function m(e,i){var o=V([e,i]),u=n(e,i);r(f,s,l,p,h,d,f=u[0],s=u[1],l=e,p=o[0],h=o[1],d=o[2],16,t),t.point(f,s)}function M(){g.point=v,t.lineEnd()}function S(){y(),g.point=E,g.lineEnd=x}function E(n,t){m(e=n,t),i=f,o=s,u=p,a=h,c=d,g.point=m}function x(){r(f,s,l,p,h,d,i,o,e,u,a,c,16,t),g.lineEnd=M,M()}return g}}(n,t):function(n){return jt({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}(n)}var Lt=jt({point:function(n,t){this.stream.point(n*P,t*P)}});function Ut(n,t,r,e,i){function o(o,u){return[t+n*(o*=e),r-n*(u*=i)]}return o.invert=function(o,u){return[(o-t)/n*e,(r-u)/n*i]},o}function zt(n,t,r,e,i,o){var u=z(o),a=H(o),c=u*n,l=a*n,f=u/n,s=a/n,p=(a*r-u*t)/n,h=(a*t+u*r)/n;function d(n,o){return[c*(n*=e)-l*(o*=i)+t,r-l*n-c*o]}return d.invert=function(n,t){return[e*(f*n-s*t+p),i*(h-s*n-f*t)]},d}function Ft(n){return function(n){var t,r,e,i,o,u,a,c,l,f,s=150,p=480,h=250,d=0,g=0,v=0,y=0,m=0,M=0,S=1,E=1,x=null,w=Nn,N=null,_=kn,b=.5;function A(n){return c(n[0]*P,n[1]*P)}function j(n){return(n=c.invert(n[0],n[1]))&&[n[0]*T,n[1]*T]}function C(){var n=zt(s,0,0,S,E,M).apply(null,t(d,g)),e=(M?zt:Ut)(s,p-n[0],h-n[1],S,E,M);return r=function(n,t,r){return(n%=k)?t||r?rn(un(n),an(t,r)):un(n):t||r?an(t,r):en}(v,y,m),a=rn(t,e),c=rn(r,a),u=Rt(a,b),R()}function R(){return l=f=null,A}return A.stream=function(n){return l&&f===n?l:l=Lt(function(n){return jt({point:function(t,r){var e=n(t,r);return this.stream.point(e[0],e[1])}})}(r)(w(u(_(f=n)))))},A.preclip=function(n){return arguments.length?(w=n,x=void 0,R()):w},A.postclip=function(n){return arguments.length?(_=n,N=e=i=o=null,R()):_},A.clipAngle=function(n){return arguments.length?(w=+n?_n(x=n*P):(x=null,Nn),R()):x*T},A.clipExtent=function(n){return arguments.length?(_=null==n?(N=e=i=o=null,kn):bn(N=+n[0][0],e=+n[0][1],i=+n[1][0],o=+n[1][1]),R()):null==N?null:[[N,e],[i,o]]},A.scale=function(n){return arguments.length?(s=+n,C()):s},A.translate=function(n){return arguments.length?(p=+n[0],h=+n[1],C()):[p,h]},A.center=function(n){return arguments.length?(d=n[0]%360*P,g=n[1]%360*P,C()):[d*T,g*T]},A.rotate=function(n){return arguments.length?(v=n[0]%360*P,y=n[1]%360*P,m=n.length>2?n[2]%360*P:0,C()):[v*T,y*T,m*T]},A.angle=function(n){return arguments.length?(M=n%360*P,C()):M*T},A.reflectX=function(n){return arguments.length?(S=n?-1:1,C()):S<0},A.reflectY=function(n){return arguments.length?(E=n?-1:1,C()):E<0},A.precision=function(n){return arguments.length?(u=Rt(a,b=n*n),R()):W(b)},A.fitExtent=function(n,t){return Tt(A,n,t)},A.fitSize=function(n,t){return function(n,t,r){return Tt(n,[[0,0],t],r)}(A,n,t)},A.fitWidth=function(n,t){return function(n,t,r){return kt(n,(function(r){var e=+t,i=e/(r[1][0]-r[0][0]),o=(e-i*(r[1][0]+r[0][0]))/2,u=-i*r[0][1];n.scale(150*i).translate([o,u])}),r)}(A,n,t)},A.fitHeight=function(n,t){return function(n,t,r){return kt(n,(function(r){var e=+t,i=e/(r[1][1]-r[0][1]),o=-i*r[0][0],u=(e-i*(r[1][1]+r[0][1]))/2;n.scale(150*i).translate([o,u])}),r)}(A,n,t)},function(){return t=n.apply(this,arguments),A.invert=t.invert&&j,C()}}((function(){return n}))()}var Ht=1.340264,Ot=-.081106,Wt=893e-6,$t=.003796,qt=W(3)/2;function Dt(n,t){var r=$(qt*H(t)),e=r*r,i=e*e*e;return[n*z(r)/(qt*(Ht+3*Ot*e+i*(7*Wt+9*$t*e))),r*(Ht+Ot*e+i*(Wt+$t*e))]}function Zt(){return Ft(Dt).scale(177.158)}function Gt(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}Dt.invert=function(n,t){for(var r,e=t,i=e*e,o=i*i*i,u=0;u<12&&(o=(i=(e-=r=(e*(Ht+Ot*i+o*(Wt+$t*i))-t)/(Ht+3*Ot*i+o*(7*Wt+9*$t*i)))*e)*i*i,!(R(r)<1e-12));++u);return[qt*n*(Ht+3*Ot*i+o*(7*Wt+9*$t*i))/z(e),$(H(e)/qt)]};var It=function(n){return 1===n.length&&(n=function(n){return function(t,r){return Gt(n(t),r)}}(n)),{left:function(t,r,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var o=e+i>>>1;n(t[o],r)<0?e=o+1:i=o}return e},right:function(t,r,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var o=e+i>>>1;n(t[o],r)>0?i=o:e=o+1}return e}}}(Gt).right;var Yt=Math.sqrt(50),Bt=Math.sqrt(10),Jt=Math.sqrt(2);function Vt(n,t,r){var e=(t-n)/Math.max(0,r),i=Math.floor(Math.log(e)/Math.LN10),o=e/Math.pow(10,i);return i>=0?(o>=Yt?10:o>=Bt?5:o>=Jt?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Yt?10:o>=Bt?5:o>=Jt?2:1)}function Xt(n,t){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(t).domain(n)}return this}function Kt(n){return+n}var Qt=[0,1];function nr(n){return n}function tr(n,t){return(t-=n=+n)?function(r){return(r-n)/t}:(r=isNaN(t)?NaN:.5,function(){return r});var r}function rr(n,t,r){var e=n[0],i=n[1],o=t[0],u=t[1];return i<e?(e=tr(i,e),o=r(u,o)):(e=tr(e,i),o=r(o,u)),function(n){return o(e(n))}}function er(n,t,r){var e=Math.min(n.length,t.length)-1,i=new Array(e),o=new Array(e),u=-1;for(n[e]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++u<e;)i[u]=tr(n[u],n[u+1]),o[u]=r(t[u],t[u+1]);return function(t){var r=It(n,t,1,e)-1;return o[r](i[r](t))}}function ir(n,t){return t.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function or(){var e,i,o,u,a,c,l=Qt,f=Qt,s=r,p=nr;function h(){var n,t,r,e=Math.min(l.length,f.length);return p!==nr&&(n=l[0],t=l[e-1],n>t&&(r=n,n=t,t=r),p=function(r){return Math.max(n,Math.min(t,r))}),u=e>2?er:rr,a=c=null,d}function d(n){return isNaN(n=+n)?o:(a||(a=u(l.map(e),f,s)))(e(p(n)))}return d.invert=function(t){return p(i((c||(c=u(f,l.map(e),n)))(t)))},d.domain=function(n){return arguments.length?(l=Array.from(n,Kt),h()):l.slice()},d.range=function(n){return arguments.length?(f=Array.from(n),h()):f.slice()},d.rangeRound=function(n){return f=Array.from(n),s=t,h()},d.clamp=function(n){return arguments.length?(p=!!n||nr,h()):p!==nr},d.interpolate=function(n){return arguments.length?(s=n,h()):s},d.unknown=function(n){return arguments.length?(o=n,d):o},function(n,t){return e=n,i=t,h()}}function ur(){return or()(nr,nr)}function ar(n,t,r,l){var f,s=function(n,t,r){var e=Math.abs(t-n)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),o=e/i;return o>=Yt?i*=10:o>=Bt?i*=5:o>=Jt&&(i*=2),t<n?-i:i}(n,t,r);switch((l=e(null==l?",f":l)).type){case"s":var p=Math.max(Math.abs(n),Math.abs(t));return null!=l.precision||isNaN(f=u(s,p))||(l.precision=f),a(l,p);case"":case"e":case"g":case"p":case"r":null!=l.precision||isNaN(f=o(s,Math.max(Math.abs(n),Math.abs(t))))||(l.precision=f-("e"===l.type));break;case"f":case"%":null!=l.precision||isNaN(f=i(s))||(l.precision=f-2*("%"===l.type))}return c(l)}function cr(n){var t=n.domain;return n.ticks=function(n){var r=t();return function(n,t,r){var e,i,o,u,a=-1;if(r=+r,(n=+n)===(t=+t)&&r>0)return[n];if((e=t<n)&&(i=n,n=t,t=i),0===(u=Vt(n,t,r))||!isFinite(u))return[];if(u>0)for(n=Math.ceil(n/u),t=Math.floor(t/u),o=new Array(i=Math.ceil(t-n+1));++a<i;)o[a]=(n+a)*u;else for(n=Math.floor(n*u),t=Math.ceil(t*u),o=new Array(i=Math.ceil(n-t+1));++a<i;)o[a]=(n-a)/u;return e&&o.reverse(),o}(r[0],r[r.length-1],null==n?10:n)},n.tickFormat=function(n,r){var e=t();return ar(e[0],e[e.length-1],null==n?10:n,r)},n.nice=function(r){null==r&&(r=10);var e,i=t(),o=0,u=i.length-1,a=i[o],c=i[u];return c<a&&(e=a,a=c,c=e,e=o,o=u,u=e),(e=Vt(a,c,r))>0?e=Vt(a=Math.floor(a/e)*e,c=Math.ceil(c/e)*e,r):e<0&&(e=Vt(a=Math.ceil(a*e)/e,c=Math.floor(c*e)/e,r)),e>0?(i[o]=Math.floor(a/e)*e,i[u]=Math.ceil(c/e)*e,t(i)):e<0&&(i[o]=Math.ceil(a*e)/e,i[u]=Math.floor(c*e)/e,t(i)),n},n}console.time("draw map"),async function(){var n=await l("../data/world-geojson.json"),t=await E("../data/data_bank_data.csv");function r(n){return n.properties.ADM0_A3_IS}var e=new Map;t.forEach((function(n){"Population growth (annual %)"==n["Series Name"]&&e.set(n["Country Code"],Number(n["2017 [YR2017]"])||0)}));var i={width:.9*window.innerWidth,margin:{top:10,right:10,bottom:10,left:10}};i.boundedWidth=i.width-i.margin.left-i.margin.right;var o={type:"Sphere"},u=Zt().fitWidth(i.boundedWidth,o),a=function(n,t){var r,e,i=4.5;function o(n){return n&&("function"==typeof i&&e.pointRadius(+i.apply(this,arguments)),B(n,r(e))),e.result()}return o.area=function(n){return B(n,r(Fn)),Fn.result()},o.measure=function(n){return B(n,r(wt)),wt.result()},o.bounds=function(n){return B(n,r(In)),In.result()},o.centroid=function(n){return B(n,r(ut)),ut.result()},o.projection=function(t){return arguments.length?(r=null==t?(n=null,kn):(n=t).stream,o):n},o.context=function(n){return arguments.length?(e=null==n?(t=null,new bt):new vt(t=n),"function"!=typeof i&&e.pointRadius(i),o):t},o.pointRadius=function(n){return arguments.length?(i="function"==typeof n?n:(e.pointRadius(+n),+n),o):i},o.projection(n).context(t)}(u),[[s,p],[h,d]]=a.bounds(o);i.boundedHeight=d,i.height=i.boundedHeight+i.margin.top+i.margin.bottom;var g=f("#wrapper").append("svg").attr("width",i.width).attr("height",i.height),v=g.append("g").style("transform",`translate(${i.margin.left}px, ${i.margin.top})`),y=function(n,t){let r,e;if(void 0===t)for(const t of n)null!=t&&(void 0===r?t>=t&&(r=e=t):(r>t&&(r=t),e<t&&(e=t)));else{let i=-1;for(let o of n)null!=(o=t(o,++i,n))&&(void 0===r?o>=o&&(r=e=o):(r>o&&(r=o),e<o&&(e=o)))}return[r,e]}(Array.from(e.values())),m=function(n,t){let r;if(void 0===t)for(const t of n)null!=t&&(r<t||void 0===r&&t>=t)&&(r=t);else{let e=-1;for(let i of n)null!=(i=t(i,++e,n))&&(r<i||void 0===r&&i>=i)&&(r=i)}return r}([-y[0],y[1]]),M=function n(){var t=ur();return t.copy=function(){return ir(t,n())},Xt.apply(t,arguments),cr(t)}().domain([-m,0,m]).range(["indigo","white","darkgreen"]),S=(v.append("path").attr("class","earth").attr("d",a(o)),Cn()),x=(v.append("path").attr("class","graticule").attr("d",a(S)),v.selectAll(".country").data(n.features).enter().append("path").attr("class","country").attr("d",a).attr("fill",(function(n){var t=e.get(r(n));return void 0===t?"#e2e6e9":M(t)}))),w=i.width<800?i.boundedHeight-30:.5*i.boundedHeight,N=g.append("g").attr("transform",`translate(120, ${w})`),_=(N.append("text").attr("y",-23).attr("class","legend-title").text("Population Growth"),N.append("text").attr("y",-9).attr("class","legend-byline").text("Percent change in 2017"),g.append("defs")),b=M.range().length;_.append("linearGradient").attr("id","legend-gradient").selectAll("stop").data(M.range()).enter().append("stop").attr("stop-color",(function(n){return n})).attr("offset",(function(n,t){return 100*t/b-1+"%"})),N.append("rect").attr("x",-60).attr("height",16).attr("width",120).style("fill","url(#legend-gradient)"),N.append("text").attr("class","legend-value").attr("x",70).attr("y",8).text(c(".1f")(m)+"%").style("text-anchor","end"),N.append("text").attr("class","legend-value").attr("x",-70).attr("y",8).text(c(".1f")(-m)+"%").style("text-anchor","end"),navigator.geolocation.getCurrentPosition((function(n){const[t,r]=u([n.coords.longitude,n.coords.latitude]);v.append("circle").attr("class","my-location").attr("cx",t).attr("cy",r).attr("r",0).transition().duration(500).attr("r",10)}));var A=f("#tooltip");x.on("mouseenter",(function(n){var t=e.get(r(n));A.select("#country").text((o=n,o.properties.NAME)),A.select("#value").text(c(",.2f")(t||0)+"%");var o;const[u,l]=a.centroid(n),f=u+i.margin.left,s=l+i.margin.top;A.style("transform",`translate(calc(-50% + ${f}px), calc(-100% + ${s}px))`),A.style("opacity",1)})).on("mouseleave",(function(){A.style("opacity",0)}))}().then(()=>console.timeEnd("draw map"));
