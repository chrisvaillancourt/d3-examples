import{a as t,b as n}from"../axis-3a2612fb.js";import{R as r,y as e,w as a,x as i,C as o,B as s,D as l,z as h,A as u,a as c,b as f,j as d,s as p,g as m}from"../precisionRound-200bdab7.js";import{D as g,s as y}from"../delaunay-7250514f.js";import{r as x,d as _}from"../math-00efd339.js";import{c as v,l as w,x as b,y as M,a as A,p as N}from"../line-a0e524d0.js";import{a as H,t as j}from"../defaultLocale-c798c300.js";import{t as T,d as C,e as Y,f as k,g as $,h as W,l as D}from"../linear-4221f875.js";var E=-.14861,B=1.78277,S=-.29227,R=-.90649,z=1.97294,F=z*R,L=z*B,X=B*S-R*E;function q(t){if(t instanceof G)return new G(t.h,t.s,t.l,t.opacity);t instanceof r||(t=e(t));var n=t.r/255,a=t.g/255,i=t.b/255,o=(X*i+F*n-L*a)/(X+F-L),s=i-o,l=(z*(a-o)-S*s)/R,h=Math.sqrt(l*l+s*s)/(z*o*(1-o)),u=h?Math.atan2(l,s)*x-120:NaN;return new G(u<0?u+360:u,h,o,t.opacity)}function P(t,n,r,e){return 1===arguments.length?q(t):new G(t,n,r,null==e?1:e)}function G(t,n,r,e){this.h=+t,this.s=+n,this.l=+r,this.opacity=+e}function I(t){return function n(r){function e(n,e){var a=t((n=P(n)).h,(e=P(e)).h),i=h(n.s,e.s),o=h(n.l,e.l),s=h(n.opacity,e.opacity);return function(t){return n.h=a(t),n.s=i(t),n.l=o(Math.pow(t,r)),n.opacity=s(t),n+""}}return r=+r,e.gamma=n,e}(1)}a(G,P,i(o,{brighter:function(t){return t=null==t?s:Math.pow(s,t),new G(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?l:Math.pow(l,t),new G(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*_,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),a=Math.cos(t),i=Math.sin(t);return new r(255*(n+e*(E*a+B*i)),255*(n+e*(S*a+R*i)),255*(n+e*(z*a)),this.opacity)}})),I(u);var J=I(h),K=(J(P(-100,.75,.35),P(80,1.5,.8)),J(P(260,.75,.35),P(80,1.5,.8)),P());function O(t,n,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+r)/6)}function Q(t){this._context=t}function U(t){return new Q(t)}function V(t){return t}Q.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:O(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:O(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};var Z=Array.prototype.slice;function tt(t){return function(){return t}}function nt(t){return Math.ceil(Math.log(function(t,n){let r=0;if(void 0===n)for(let n of t)null!=n&&(n=+n)>=n&&++r;else{let e=-1;for(let a of t)null!=(a=n(a,++e,t))&&(a=+a)>=a&&++r}return r}(t))/Math.LN2)+1}function rt(){var t=V,n=Y,r=nt;function e(e){Array.isArray(e)||(e=Array.from(e));var a,i,o=e.length,s=new Array(o);for(a=0;a<o;++a)s[a]=t(e[a],a,e);var l=n(s),h=l[0],u=l[1],c=r(s,h,u);Array.isArray(c)||(c=T(h,u,c),c=function(t,n,r){t=+t,n=+n,r=(a=arguments.length)<2?(n=t,t=0,1):a<3?1:+r;for(var e=-1,a=0|Math.max(0,Math.ceil((n-t)/r)),i=new Array(a);++e<a;)i[e]=t+e*r;return i}(Math.ceil(h/c)*c,u,c));for(var f=c.length;c[0]<=h;)c.shift(),--f;for(;c[f-1]>u;)c.pop(),--f;var d,p=new Array(f+1);for(a=0;a<=f;++a)(d=p[a]=[]).x0=a>0?c[a-1]:h,d.x1=a<f?c[a]:u;for(a=0;a<o;++a)h<=(i=s[a])&&i<=u&&p[C(c,i,0,f)].push(e[a]);return p}return e.value=function(n){return arguments.length?(t="function"==typeof n?n:tt(n),e):t},e.domain=function(t){return arguments.length?(n="function"==typeof t?t:tt([t[0],t[1]]),e):n},e.thresholds=function(t){return arguments.length?(r="function"==typeof t?t:Array.isArray(t)?tt(Z.call(t)):tt(t),e):r},e}function et(){var t,n,r,e,a,i=0,o=1,s=$,l=!1;function h(n){return isNaN(n=+n)?a:s(0===r?.5:(n=(e(n)-t)*r,l?Math.max(0,Math.min(1,n)):n))}function u(t){return function(n){var r,e;return arguments.length?([r,e]=n,s=t(r,e),h):[s(0),s(1)]}}return h.domain=function(a){return arguments.length?([i,o]=a,t=e(i=+i),n=e(o=+o),r=t===n?0:1/(n-t),h):[i,o]},h.clamp=function(t){return arguments.length?(l=!!t,h):l},h.interpolator=function(t){return arguments.length?(s=t,h):s},h.range=u(f),h.rangeRound=u(c),h.unknown=function(t){return arguments.length?(a=t,h):a},function(a){return e=a,t=a(i),n=a(o),r=t===n?0:1/(n-t),h}}function at(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function it({data:t,scale:n,accessor:r,dimensions:e,histogramClass:a,chartTransform:i,chartBounds:o,pathClass:s}){var l=rt().domain(n.domain()).value(r).thresholds(20)(t),h=D().domain(Y(l,t=>t.length)).range([e.histogramHeight,0]),u=o.append("g").attr("class",a).style("transform",i),c=function(){var t=b,n=null,r=v(0),e=M,a=v(!0),i=null,o=A,s=null;function l(l){var h,u,c,f,d,p=l.length,m=!1,g=new Array(p),y=new Array(p);for(null==i&&(s=o(d=N())),h=0;h<=p;++h){if(!(h<p&&a(f=l[h],h,l))===m)if(m=!m)u=h,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),c=h-1;c>=u;--c)s.point(g[c],y[c]);s.lineEnd(),s.areaEnd()}m&&(g[h]=+t(f,h,l),y[h]=+r(f,h,l),s.point(n?+n(f,h,l):g[h],e?+e(f,h,l):y[h]))}if(d)return s=null,d+""||null}function h(){return w().defined(a).curve(o).context(i)}return l.x=function(r){return arguments.length?(t="function"==typeof r?r:v(+r),n=null,l):t},l.x0=function(n){return arguments.length?(t="function"==typeof n?n:v(+n),l):t},l.x1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:v(+t),l):n},l.y=function(t){return arguments.length?(r="function"==typeof t?t:v(+t),e=null,l):r},l.y0=function(t){return arguments.length?(r="function"==typeof t?t:v(+t),l):r},l.y1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:v(+t),l):e},l.lineX0=l.lineY0=function(){return h().x(t).y(r)},l.lineY1=function(){return h().x(t).y(e)},l.lineX1=function(){return h().x(n).y(r)},l.defined=function(t){return arguments.length?(a="function"==typeof t?t:v(!!t),l):a},l.curve=function(t){return arguments.length?(o=t,null!=i&&(s=o(i)),l):o},l.context=function(t){return arguments.length?(null==t?i=s=null:s=o(i=t),l):i},l}().x(t=>n((t.x0+t.x1)/2)).y0(e.histogramHeight).y1(t=>h(t.length)).curve(U);u.append("path").attr("d",t=>c(l)).attr("class",s)}console.time("render chart"),async function(){const r=await d("../data/nyc_weather_data.json");function e(t){return t.temperatureMin}function a(t){return t.temperatureMax}var i=H("%Y-%m-%d"),o=function({customDimensions:t={}}={}){return{margin:{top:90,right:90,bottom:50,left:50},get width(){return.95*(window.innerWidth-this.margin.left-this.margin.right)},get boundedWidth(){return this.width-this.margin.left-this.margin.right},get height(){return this.width},get boundedHeight(){return this.height-this.margin.top-this.margin.bottom},...t}}({customDimensions:{histogramMargin:10,histogramHeight:70}});const s=p("#wrapper").append("svg").attr("width",o.width).attr("height",o.height).append("g").style("transform",`translate(${o.margin.left}px, ${o.margin.top}px)`);s.append("rect").classed("bounds-background",!0).attr("x",0).attr("width",o.boundedWidth).attr("y",0).attr("height",o.boundedHeight);var l=Y([...r.map(e),...r.map(a)]);const h=D().domain(l).range([0,o.boundedWidth]).nice(),u=D().domain(l).range([o.boundedHeight,0]).nice();var c=function t(){var n=k(et()($));return n.copy=function(){return at(n,t())},W.apply(n,arguments)}().domain([H("%m/%d/%Y")("1/1/2000"),H("%m/%d/%Y")("12/31/2000")]).interpolator((function(t){return function(t){(t<0||t>1)&&(t-=Math.floor(t));var n=Math.abs(t-.5);return K.h=360*t-100,K.s=1.5-1.5*n,K.l=.8-.9*n,K+""}(-t)}));(t=>{s.append("g").selectAll(".dot").data(t,t=>t[0]).join("circle").attr("class","dot").attr("cx",t=>h(e(t))).attr("cy",t=>u(a(t))).attr("r",4).style("fill",(function(t){return c(function(t){return i(t.date).setYear(2e3)}(t))}))})(r),it({data:r,scale:u,accessor:a,chartBounds:s,dimensions:o,histogramClass:"top-histogram",pathClass:"histogram-area",chartTransform:`translate(\n        ${o.boundedWidth+o.histogramMargin}px, -${o.histogramHeight}px) rotate(90deg)`}),it({data:r,scale:h,accessor:e,chartBounds:s,dimensions:o,histogramClass:"right-histogram",pathClass:"histogram-area",chartTransform:`translate(0px, ${-o.histogramHeight-o.histogramMargin}px)`});var f=g.from(r,t=>h(e(t)),t=>u(a(t))).voronoi();f.xmax=o.boundedWidth,f.ymax=o.boundedHeight,s.selectAll(".voronoi").data(r).enter().append("path").attr("class","voronoi").attr("d",(function(t,n){return f.renderCell(n)}));const x=t().scale(h),_=(s.append("g").call(x).style("transform",`translateY(${o.boundedHeight}px)`).append("text").attr("class","x-axis-label").attr("x",o.boundedWidth/2).attr("y",o.margin.bottom-10).html("Minimum Temperature (&deg;F)"),n().scale(u).ticks(4));s.append("g").call(_).append("text").attr("class","y-axis-label").attr("x",-o.boundedHeight/2).attr("y",10-o.margin.left).html("Maximum Temperature (&deg;F)");var v=p("#tooltip"),w=m(".2f"),b=m(".2f"),M=H("%Y-%m-%d"),A=j("%B %A %-d, %Y");s.selectAll(".voronoi").on("mouseenter",(function(t,n){v.select("#humidity").text(w(a(t))),v.select("#dew-point").text(b(e(t))),v.select("#date").text(A(M(t.date)));const r=h(e(t))+o.margin.left,i=u(a(t))+o.margin.top;v.style("transform",`translate(calc(-50% + ${r}px), calc(-100% + ${i}px))`).style("opacity",1);s.append("circle").attr("class","tooltipDot").attr("cx",h(e(t))).attr("cy",u(a(t))).attr("r",7).style("fill","maroon").style("pointer-events","none")})).on("mouseleave",(function(){v.style("opacity",0),y(".tooltipDot").remove()}))}().then(()=>console.timeEnd("render chart")).catch(console.error);
