import{b as t,a as e}from"../axis-3a2612fb.js";import"../index-b9fbf715.js";import{j as a,s as n}from"../precisionRound-200bdab7.js";import{l as r}from"../line-a0e524d0.js";import{t as i,d as s,s as o,y as d,a as l}from"../defaultLocale-c798c300.js";import{m as c,s as p,a as u,h}from"../hour-97e15ea5.js";import{m}from"../month-a8d9f45c.js";import{i as f,c as g,a as b,b as w,t as x,l as y,e as v}from"../linear-4221f875.js";function j(t){return new Date(t)}function D(t){return t instanceof Date?+t:+new Date(+t)}function M(t,e,a,n,r,i,s,o,d){var l=g(),c=l.invert,p=l.domain,u=d(".%L"),h=d(":%S"),m=d("%I:%M"),f=d("%I %p"),y=d("%a %d"),v=d("%b %d"),H=d("%B"),W=d("%Y"),Y=[[s,1,1e3],[s,5,5e3],[s,15,15e3],[s,30,3e4],[i,1,6e4],[i,5,3e5],[i,15,9e5],[i,30,18e5],[r,1,36e5],[r,3,108e5],[r,6,216e5],[r,12,432e5],[n,1,864e5],[n,2,1728e5],[a,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function $(o){return(s(o)<o?u:i(o)<o?h:r(o)<o?m:n(o)<o?f:e(o)<o?a(o)<o?y:v:t(o)<o?H:W)(o)}function I(e,a,n){if(null==e&&(e=10),"number"==typeof e){var r,i=Math.abs(n-a)/e,s=w((function(t){return t[2]})).right(Y,i);return s===Y.length?(r=x(a/31536e6,n/31536e6,e),e=t):s?(r=(s=Y[i/Y[s-1][2]<Y[s][2]/i?s-1:s])[1],e=s[0]):(r=Math.max(x(a,n,e),1),e=o),e.every(r)}return e}return l.invert=function(t){return new Date(c(t))},l.domain=function(t){return arguments.length?p(Array.from(t,D)):p().map(j)},l.ticks=function(t){var e,a=p(),n=a[0],r=a[a.length-1],i=r<n;return i&&(e=n,n=r,r=e),e=(e=I(t,n,r))?e.range(n,r+1):[],i?e.reverse():e},l.tickFormat=function(t,e){return null==e?$:d(e)},l.nice=function(t){var e=p();return(t=I(t,e[0],e[e.length-1]))?p(function(t,e){var a,n=0,r=(t=t.slice()).length-1,i=t[n],s=t[r];return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),t[n]=e.floor(i),t[r]=e.ceil(s),t}(e,t)):l},l.copy=function(){return b(l,M(t,e,a,n,r,i,s,o,d))},l}console.time("draw line"),async function(){let g=await a("../data/nyc_weather_data.json");const b=t=>t.temperatureMax,w=l("%Y-%m-%d"),x=t=>w(t.date);g=g.sort((t,e)=>x(t)-x(e)).slice(0,100);let j={width:.9*window.innerWidth,height:400,margin:{top:15,right:15,bottom:40,left:60}};j.boundedWidth=j.width-j.margin.left-j.margin.right,j.boundedHeight=j.height-j.margin.top-j.margin.bottom;const D=n("#wrapper").append("svg").attr("width",j.width).attr("height",j.height).append("g").style("transform",`translate(${j.margin.left}px, ${j.margin.top}px)`);D.append("defs").append("clipPath").attr("id","bounds-clip-path").append("rect").attr("width",j.boundedWidth).attr("height",j.boundedHeight),D.append("rect").attr("class","freezing"),D.append("g").attr("clip-path","url(#bounds-clip-path)").append("path").attr("class","line"),D.append("path").attr("class","line"),D.append("g").attr("class","x-axis").style("transform",`translateY(${j.boundedHeight}px)`),D.append("g").attr("class","y-axis");const H=a=>{const n=y().domain(v(a,b)).range([j.boundedHeight,0]),l=n(32),g=(D.select(".freezing").attr("x",0).attr("width",j.boundedWidth).attr("y",l).attr("height",j.boundedHeight-l),function(){return f.apply(M(d,m,o,s,h,u,p,c,i).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}().domain(v(a.slice(2),x)).range([0,j.boundedWidth])),w=r().x(t=>g(x(t))).y(t=>n(b(t)));var H=a.slice(-2),W=g(x(H[1]))-g(x(H[0]));D.select(".line").attr("d",w(a)).style("transform",`translateX(${W}px)`).transition().duration(1e3).style("transform","none");const Y=t().scale(n),$=(D.select(".y-axis").call(Y),e().scale(g));D.select(".x-axis").transition().duration(1e3).call($)};function W(t){const e=t[t.length-1],a=s.offset(x(e),1);return{date:i("%Y-%m-%d")(a),temperatureMax:b(e)+(6*Math.random()-3)}}H(g),setInterval((function(){g=[...g.slice(1),W(g)],H(g)}),1500)}().then(()=>console.timeEnd("draw line"));
