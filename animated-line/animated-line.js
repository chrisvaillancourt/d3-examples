import{b as t,a as e}from"../bisect-ada9d806.js";import{s as n}from"../precisionRound-37c4ad23.js";import{m as a,s as r,a as i,h as s,b as o,l as d}from"../line-7e971be0.js";import{j as c}from"../json-3227c80e.js";import{t as l,d as p,s as u,y as h,a as m}from"../defaultLocale-1a6cbc98.js";import{i as f,c as g,a as b,b as w,t as y,l as x,e as v}from"../linear-8bbfb6b8.js";function j(t){return new Date(t)}function D(t){return t instanceof Date?+t:+new Date(+t)}function M(t,e,n,a,r,i,s,o,d){var c=g(),l=c.invert,p=c.domain,u=d(".%L"),h=d(":%S"),m=d("%I:%M"),f=d("%I %p"),x=d("%a %d"),v=d("%b %d"),H=d("%B"),W=d("%Y"),Y=[[s,1,1e3],[s,5,5e3],[s,15,15e3],[s,30,3e4],[i,1,6e4],[i,5,3e5],[i,15,9e5],[i,30,18e5],[r,1,36e5],[r,3,108e5],[r,6,216e5],[r,12,432e5],[a,1,864e5],[a,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function $(o){return(s(o)<o?u:i(o)<o?h:r(o)<o?m:a(o)<o?f:e(o)<o?n(o)<o?x:v:t(o)<o?H:W)(o)}function I(e,n,a){if(null==e&&(e=10),"number"==typeof e){var r,i=Math.abs(a-n)/e,s=w((function(t){return t[2]})).right(Y,i);return s===Y.length?(r=y(n/31536e6,a/31536e6,e),e=t):s?(r=(s=Y[i/Y[s-1][2]<Y[s][2]/i?s-1:s])[1],e=s[0]):(r=Math.max(y(n,a,e),1),e=o),e.every(r)}return e}return c.invert=function(t){return new Date(l(t))},c.domain=function(t){return arguments.length?p(Array.from(t,D)):p().map(j)},c.ticks=function(t){var e,n=p(),a=n[0],r=n[n.length-1],i=r<a;return i&&(e=a,a=r,r=e),e=(e=I(t,a,r))?e.range(a,r+1):[],i?e.reverse():e},c.tickFormat=function(t,e){return null==e?$:d(e)},c.nice=function(t){var e=p();return(t=I(t,e[0],e[e.length-1]))?p(function(t,e){var n,a=0,r=(t=t.slice()).length-1,i=t[a],s=t[r];return s<i&&(n=a,a=r,r=n,n=i,i=s,s=n),t[a]=e.floor(i),t[r]=e.ceil(s),t}(e,t)):c},c.copy=function(){return b(c,M(t,e,n,a,r,i,s,o,d))},c}console.time("draw line"),async function(){let g=await c("../data/nyc_weather_data.json");const b=t=>t.temperatureMax,w=m("%Y-%m-%d"),y=t=>w(t.date);g=g.sort((t,e)=>y(t)-y(e)).slice(0,100);let j={width:.9*window.innerWidth,height:400,margin:{top:15,right:15,bottom:40,left:60}};j.boundedWidth=j.width-j.margin.left-j.margin.right,j.boundedHeight=j.height-j.margin.top-j.margin.bottom;const D=n("#wrapper").append("svg").attr("width",j.width).attr("height",j.height).append("g").style("transform",`translate(${j.margin.left}px, ${j.margin.top}px)`);D.append("defs").append("clipPath").attr("id","bounds-clip-path").append("rect").attr("width",j.boundedWidth).attr("height",j.boundedHeight),D.append("rect").attr("class","freezing"),D.append("g").attr("clip-path","url(#bounds-clip-path)").append("path").attr("class","line"),D.append("path").attr("class","line"),D.append("g").attr("class","x-axis").style("transform",`translateY(${j.boundedHeight}px)`),D.append("g").attr("class","y-axis");const H=n=>{const c=x().domain(v(n,b)).range([j.boundedHeight,0]),m=c(32),g=(D.select(".freezing").attr("x",0).attr("width",j.boundedWidth).attr("y",m).attr("height",j.boundedHeight-m),function(){return f.apply(M(h,o,u,p,s,i,r,a,l).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}().domain(v(n.slice(2),y)).range([0,j.boundedWidth])),w=d().x(t=>g(y(t))).y(t=>c(b(t)));var H=n.slice(-2),W=g(y(H[1]))-g(y(H[0]));D.select(".line").attr("d",w(n)).style("transform",`translateX(${W}px)`).transition().duration(1e3).style("transform","none");const Y=t().scale(c),$=(D.select(".y-axis").call(Y),e().scale(g));D.select(".x-axis").transition().duration(1e3).call($)};function W(t){const e=t[t.length-1],n=p.offset(y(e),1);return{date:l("%Y-%m-%d")(n),temperatureMax:b(e)+(6*Math.random()-3)}}H(g),setInterval((function(){g=[...g.slice(1),W(g)],H(g)}),1500)}().then(()=>console.timeEnd("draw line"));
