import{E as t,j as n,s as e,g as r}from"../precisionRound-f2241ba6.js";import{m as a}from"../mouse-dfac9017.js";import{c as i,p as o,a as c}from"../line-a0e524d0.js";import{t as u,a as f}from"../defaultLocale-6888ceff.js";import"../hour-4cecfcf7.js";import{a as l}from"../month-fdf3866f.js";import{a as s,s as d}from"../sequential-d87bfd9f.js";import{i as p,k as h,g as y,a as m,h as x,e as g,l as v}from"../linear-3681a81c.js";import{r as b}from"../range-e5956162.js";import{s as M}from"../time-717451d1.js";var w=function(n){return t(n[n.length-1])}(new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map((function(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e}))),R=Math.abs,A=Math.atan2,I=Math.cos,P=Math.max,j=Math.min,E=Math.sin,T=Math.sqrt,_=Math.PI,G=_/2,k=2*_;function S(t){return t>1?0:t<-1?_:Math.acos(t)}function Y(t){return t>=1?G:t<=-1?-G:Math.asin(t)}function $(t){return t.innerRadius}function q(t){return t.outerRadius}function F(t){return t.startAngle}function X(t){return t.endAngle}function C(t){return t&&t.padAngle}function W(t,n,e,r,a,i,o,c){var u=e-t,f=r-n,l=o-a,s=c-i,d=s*u-l*f;if(!(d*d<1e-12))return[t+(d=(l*(n-i)-s*(t-a))/d)*u,n+d*f]}function z(t,n,e,r,a,i,o){var c=t-e,u=n-r,f=(o?i:-i)/T(c*c+u*u),l=f*u,s=-f*c,d=t+l,p=n+s,h=e+l,y=r+s,m=(d+h)/2,x=(p+y)/2,g=h-d,v=y-p,b=g*g+v*v,M=a-i,w=d*y-h*p,R=(v<0?-1:1)*T(P(0,M*M*b-w*w)),A=(w*v-g*R)/b,I=(-w*g-v*R)/b,j=(w*v+g*R)/b,E=(-w*g+v*R)/b,_=A-m,G=I-x,k=j-m,S=E-x;return _*_+G*G>k*k+S*S&&(A=j,I=E),{cx:A,cy:I,x01:-l,y01:-s,x11:A*(a/M-1),y11:I*(a/M-1)}}var D=L(c);function H(t){this._curve=t}function L(t){function n(n){return new H(t(n))}return n._curve=t,n}function O(t){var n=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?n(L(t)):n()._curve},t}function U(){var t=s().curve(D),n=t.curve,e=t.lineX0,r=t.lineX1,a=t.lineY0,i=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return O(e())},delete t.lineX0,t.lineEndAngle=function(){return O(r())},delete t.lineX1,t.lineInnerRadius=function(){return O(a())},delete t.lineY0,t.lineOuterRadius=function(){return O(i())},delete t.lineY1,t.curve=function(t){return arguments.length?n(L(t)):n()._curve},t}H.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t))}};const V=Symbol("implicit");function B(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function J(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function K(t){return t<0?-t*t:t*t}function N(t){var n=t(x,x),e=1;function r(){return 1===e?t(x,x):.5===e?t(J,K):t(B(e),B(1/e))}return n.exponent=function(t){return arguments.length?(e=+t,r()):e},y(n)}function Q(){var t=N(h());return t.copy=function(){return m(t,Q()).exponent(t.exponent())},p.apply(t,arguments),t}function Z(){return Q.apply(null,arguments).exponent(.5)}console.time("create radar chart"),async function(){console.time("load data");var t=await n("../data/nyc_weather_data.json");function c(t){return t.temperatureMin}function s(t){return t.temperatureMax}function h(t){return t.uvIndex}function y(t){return t.precipProbability}function m(t){return t.precipType}function x(t){return t.cloudCover}console.timeEnd("load data");var P=u("%Y-%m-%d");function D(t){return P(t.date)}var H=function({customDimensions:t={}}={}){return{margin:{top:120,right:120,bottom:120,left:120},get width(){return.75*((window.innerWidth>1500?1500:window.innerWidth)-this.margin.left-this.margin.right)},get boundedWidth(){return this.width-this.margin.left-this.margin.right},get height(){return this.width},get boundedHeight(){return this.height-this.margin.top-this.margin.bottom},get radius(){return this.width/2},get boundedRadius(){return this.radius-(this.margin.left+this.margin.right)/2},...t}}(),L=e("#wrapper").append("svg").attr("width",H.width).attr("height",H.height),O=L.append("g").style("transform",`translate(${H.margin.left+H.boundedRadius}px, ${H.margin.top+H.boundedRadius}px)`),B=L.append("defs").append("radialGradient").attr("id","temperature-gradient"),J=w;b(10).forEach((function(t){B.append("stop").attr("offset",100*t/9+"%").attr("stop-color",J(t/9))}));var K=M().domain(g(t,D)).range([0,2*Math.PI]),N=v().domain(g([...t.map(s),...t.map(c)])).range([0,H.boundedRadius]).nice();function Q(t,n=1.4){return ct(K(D(t)),n)[0]}function tt(t,n=1.4){return ct(K(D(t)),n)[1]}var nt=Z().domain(g(t,x)).range([1,10]),et=Z().domain(g(t,y)).range([1,8]),rt=["rain","sleet","snow"],at=function t(){var n=new Map,e=[],r=[],a=V;function i(t){var i=t+"",o=n.get(i);if(!o){if(a!==V)return a;n.set(i,o=e.push(t))}return r[(o-1)%r.length]}return i.domain=function(t){if(!arguments.length)return e.slice();e=[],n=new Map;for(const r of t){const t=r+"";n.has(t)||n.set(t,e.push(r))}return i},i.range=function(t){return arguments.length?(r=Array.from(t),i):r.slice()},i.unknown=function(t){return arguments.length?(a=t,i):a},i.copy=function(){return t(e,r).unknown(a)},p.apply(i,arguments),i}().domain(rt).range(["#54a0ff","#636e72","#b2bec3"]),it=d().domain(g([...t.map(s),...t.map(c)])).interpolator(J),ot=O.append("g");function ct(t,n=1){return[Math.cos(t-Math.PI/2)*H.boundedRadius*n,Math.sin(t-Math.PI/2)*H.boundedRadius*n]}l(...K.domain()).forEach((function(t){var n=K(t);const[e,r]=ct(n);ot.append("line").attr("x2",e).attr("y2",r).attr("class","grid-line");const[a,i]=ct(n,1.38);ot.append("text").attr("x",a).attr("y",i).attr("class","tick-label").text(f("%b")(t)).style("text-anchor",Math.abs(a)<5?"middle":a>0?"start":"end")}));var ut=N.ticks(4);ut.map((function(t){return ot.append("circle").attr("r",N(t)).attr("class","grid-line")})),ut.map((function(t){if(t)return ot.append("rect").attr("y",-N(t)-10).attr("width",40).attr("height",20).attr("fill","#ffffff")})),ut.map((function(t){if(t)return ot.append("text").attr("x",4).attr("y",2-N(t)).attr("class","tick-label-temperature").html(r(".0f")(t)+"°F")}));var ft=N.domain()[0]<32;if(ft){O.append("circle").attr("r",N(32)).attr("class","freezing-circle")}var lt=U().angle((function(t){return K(D(t))})).innerRadius((function(t){return N(c(t))})).outerRadius((function(t){return N(s(t))}));O.append("path").attr("d",lt(t)).attr("fill","url(#temperature-gradient)"),O.append("g").selectAll("line").data(t.filter((function(t){return h(t)>8}))).enter().append("line").attr("class","uv-line").attr("x1",t=>Q(t,.95)).attr("x2",t=>Q(t,1.05)).attr("y1",t=>tt(t,.95)).attr("y2",t=>tt(t,1.05)),O.append("g").selectAll("circle").data(t).enter().append("circle").attr("class","cloud-dot").attr("cx",(function(t){return Q(t,1.27)})).attr("cy",(function(t){return tt(t,1.27)})).attr("r",(function(t){return nt(x(t))})),O.append("g").selectAll("circle").data(t.filter(m)).enter().append("circle").attr("class","precipitation-dot").attr("cx",(function(t){return Q(t,1.14)})).attr("cy",(function(t){return tt(t,1.14)})).attr("r",(function(t){return et(y(t))})).style("fill",(function(t){return at(m(t))}));var st=O.append("g");function dt({angle:t,offset:n,text:e,annotationGrp:r}){const[a,i]=ct(t,n),[o,c]=ct(t,1.6);r.append("line").attr("class","annotation-line").attr("x1",a).attr("x2",o).attr("y1",i).attr("y2",c),r.append("text").attr("class","annotation-text").attr("x",o+6).attr("y",c).text(e)}const pt=.23*Math.PI,ht=.26*Math.PI,yt=.734*Math.PI,mt=.7*Math.PI,xt=.9*Math.PI,gt=N(32)/H.boundedRadius;dt({angle:pt,offset:1.27,text:"Cloud Cover",annotationGrp:st}),dt({angle:ht,offset:1.14,text:"Precipitation",annotationGrp:st}),dt({angle:yt,offset:1,text:"UV Index over 8",annotationGrp:st}),dt({angle:mt,offset:.5,text:"Temperature",annotationGrp:st}),ft&&dt({angle:xt,offset:gt,text:"Freezing Temperatures",annotationGrp:st});const vt=.26*Math.PI,bt=t=>16*(t+1),[Mt,wt]=ct(vt,1.6);rt.forEach((function(t,n){st.append("circle").attr("cx",Mt+15).attr("cy",wt+bt(n)).attr("r",4).style("opacity",.7).attr("fill",at(t)),st.append("text").attr("class","annotation-text").attr("x",Mt+25).attr("y",wt+bt(n)).text(t)}));var Rt=e("#tooltip"),At=Rt.select("#tooltip-temperature-min"),It=Rt.select("#tooltip-temperature-max"),Pt=Rt.select("#tooltip-uv"),jt=Rt.select("#tooltip-cloud"),Et=Rt.select("#tooltip-precipitation"),Tt=Rt.select("#tooltip-precipitation-type"),_t=Rt.select(".tooltip-precipitation-type"),Gt=O.append("path").attr("class","tooltip-line");O.append("circle").attr("class","listener-circle").attr("r",H.width/2).on("mousemove",(function(n){const[e,u]=a(this);var l=function(t,n){return Math.atan2(n,t)}(e,u)+Math.PI/2;l<0&&(l=2*Math.PI+l);var d=function(){var t=$,n=q,e=i(0),r=null,a=F,c=X,u=C,f=null;function l(){var i,l,s=+t.apply(this,arguments),d=+n.apply(this,arguments),p=a.apply(this,arguments)-G,h=c.apply(this,arguments)-G,y=R(h-p),m=h>p;if(f||(f=i=o()),d<s&&(l=d,d=s,s=l),d>1e-12)if(y>k-1e-12)f.moveTo(d*I(p),d*E(p)),f.arc(0,0,d,p,h,!m),s>1e-12&&(f.moveTo(s*I(h),s*E(h)),f.arc(0,0,s,h,p,m));else{var x,g,v=p,b=h,M=p,w=h,P=y,$=y,q=u.apply(this,arguments)/2,F=q>1e-12&&(r?+r.apply(this,arguments):T(s*s+d*d)),X=j(R(d-s)/2,+e.apply(this,arguments)),C=X,D=X;if(F>1e-12){var H=Y(F/s*E(q)),L=Y(F/d*E(q));(P-=2*H)>1e-12?(M+=H*=m?1:-1,w-=H):(P=0,M=w=(p+h)/2),($-=2*L)>1e-12?(v+=L*=m?1:-1,b-=L):($=0,v=b=(p+h)/2)}var O=d*I(v),U=d*E(v),V=s*I(w),B=s*E(w);if(X>1e-12){var J,K=d*I(b),N=d*E(b),Q=s*I(M),Z=s*E(M);if(y<_&&(J=W(O,U,Q,Z,K,N,V,B))){var tt=O-J[0],nt=U-J[1],et=K-J[0],rt=N-J[1],at=1/E(S((tt*et+nt*rt)/(T(tt*tt+nt*nt)*T(et*et+rt*rt)))/2),it=T(J[0]*J[0]+J[1]*J[1]);C=j(X,(s-it)/(at-1)),D=j(X,(d-it)/(at+1))}}$>1e-12?D>1e-12?(x=z(Q,Z,O,U,d,D,m),g=z(K,N,V,B,d,D,m),f.moveTo(x.cx+x.x01,x.cy+x.y01),D<X?f.arc(x.cx,x.cy,D,A(x.y01,x.x01),A(g.y01,g.x01),!m):(f.arc(x.cx,x.cy,D,A(x.y01,x.x01),A(x.y11,x.x11),!m),f.arc(0,0,d,A(x.cy+x.y11,x.cx+x.x11),A(g.cy+g.y11,g.cx+g.x11),!m),f.arc(g.cx,g.cy,D,A(g.y11,g.x11),A(g.y01,g.x01),!m))):(f.moveTo(O,U),f.arc(0,0,d,v,b,!m)):f.moveTo(O,U),s>1e-12&&P>1e-12?C>1e-12?(x=z(V,B,K,N,s,-C,m),g=z(O,U,Q,Z,s,-C,m),f.lineTo(x.cx+x.x01,x.cy+x.y01),C<X?f.arc(x.cx,x.cy,C,A(x.y01,x.x01),A(g.y01,g.x01),!m):(f.arc(x.cx,x.cy,C,A(x.y01,x.x01),A(x.y11,x.x11),!m),f.arc(0,0,s,A(x.cy+x.y11,x.cx+x.x11),A(g.cy+g.y11,g.cx+g.x11),m),f.arc(g.cx,g.cy,C,A(g.y11,g.x11),A(g.y01,g.x01),!m))):f.arc(0,0,s,w,M,m):f.lineTo(V,B)}else f.moveTo(0,0);if(f.closePath(),i)return f=null,i+""||null}return l.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +c.apply(this,arguments))/2-_/2;return[I(r)*e,E(r)*e]},l.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:i(+n),l):t},l.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:i(+t),l):n},l.cornerRadius=function(t){return arguments.length?(e="function"==typeof t?t:i(+t),l):e},l.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:i(+t),l):r},l.startAngle=function(t){return arguments.length?(a="function"==typeof t?t:i(+t),l):a},l.endAngle=function(t){return arguments.length?(c="function"==typeof t?t:i(+t),l):c},l.padAngle=function(t){return arguments.length?(u="function"==typeof t?t:i(+t),l):u},l.context=function(t){return arguments.length?(f=null==t?null:t,l):f},l}().innerRadius(0).outerRadius(1.6*H.boundedRadius).startAngle(l-.015).endAngle(l+.015);Gt.attr("d",d()).style("opacity",1);var[p,g]=ct(l,1.6);Rt.style("opacity",1).style("transform",`translate(\n        calc(${p<-50?"40px - 100":p>50?"-40px + 0":"-50"}%\n        + ${p+H.margin.top+H.boundedRadius}px),\n        calc(${g<-50?"40px - 100":g>50?"-40px + 0":"-50"}% + ${g+H.margin.top+H.boundedRadius}px)\n      )`);var v=K.invert(l),b=f("%Y-%m-%d")(v),M=t.filter((function(t){return t.date==b}))[0];if(!M)return;At.html(r(".1f")(c(M))+"°F"),It.html(r(".1f")(s(M))+"°F"),Pt.text(h(M)),jt.text(x(M)),Et.text(r(".0%")(y(M))),Tt.text(m(M)),_t.style("color",m(M)?at(m(M)):"#dadadd"),At.style("color",it(c(M))),It.style("color",it(s(M)))})).on("mouseleave",(function(t){Gt.style("opacity",0),Rt.style("opacity",0)}))}().then(()=>console.timeEnd("create radar chart")).catch(console.error);
